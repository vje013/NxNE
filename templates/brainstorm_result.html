<!-- brainstorm_result.html -->
<div id="wrapper">
    <div id="header">
        <div class="logo">
            <span class="icon fa-pencil-alt"></span>
        </div>
        <div class="content">
            <div class="inner">
                <h1>Brainstorm Results</h1>
                <h2>Your {{ role.title }}'s suggestions for: {{ problem }}</h2>
                
                <p>⏯ (Coming Soon)</p>
                
                <ol id="suggestions-list">
                    {% for suggestion in suggestions.split('\n') %}
                        <li class="suggestion" data-suggestion="{{ suggestion }}">{{ suggestion }}</li>
                    {% endfor %}
                </ol>
                
                <div id="deeper-dive">
                    <!-- This is where the deeper dive content will be displayed -->
                </div>
                
                <div class="actions">
                    <a href="/brainstorm" class="button">Back to Brainstorm</a>
                </div>
            </div>
        </div>
    </div>
    
    <footer>© NxNE2024@gmail.com</footer>
</div>

<div id="bg"></div>

<div id="loading">
    <img src="{{ url_for('static', filename='assets/LoadingAsset_Business2.png') }}" alt="Loading...">
    <p>Your NxNE C-Suite is diving deep...</p>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('.suggestion').click(function() {
        var suggestion = $(this).data('suggestion');
        var problem = "{{ problem }}";
        var role = "{{ role.title }}";
        
        $('#loading').show();
        
        $.ajax({
            url: '/dive_deeper',
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify({
                role: role,
                problem: problem,
                suggestion: suggestion,
                query: "Please provide more details and implementation steps for this suggestion."
            }),
            success: function(response) {
                $('#loading').hide();
                var deeperDive = '<h3>Deeper Dive:</h3><ul>';
                response.suggestions.forEach(function(item) {
                    deeperDive += '<li>' + item + '</li>';
                });
                deeperDive += '</ul>';
                $('#deeper-dive').html(deeperDive);
            },
            error: function() {
                $('#loading').hide();
                alert('An error occurred while fetching the deeper dive.');
            }
        });
    });
});
</script>